<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Allele frequency and ancestral estimate evolution</title><script language="JavaScript" type="text/javascript" src="FUN.js"></script><link href="ANI.css" rel="stylesheet" type="text/css" /></head><body onload=loading('ANIR')><div align="center" class="anidemo" title="Allele frequency and ancestral estimate evolution"><fieldset><legend align="center">Allele frequency and ancestral estimate evolution</legend><div id="loadingANIR" class="loading">loading animation frames... </div><div id="divPreloadANIR" class="divPreload">
<script language="JavaScript" type="text/javascript">
 var sourceANIR = "images/"; var imgtypeANIR = "png"; var tmpANIR = 0; var nmaxANIR=200; var nANIR=1; var tANIR;
 for(i = 1; i <= nmaxANIR; i++){document.write("<div class=\"divFrame\" id=\"divPreloadANIR" + i + "\"><img src=\"" + sourceANIR + i + "." + imgtypeANIR + "\"" + " id = \"img" + "ANIR" + i + "\" alt=\"Allele frequency and ancestral estimate evolution\" title=\"Allele frequency and ancestral estimate evolution\" /></div>");}
</script></div><div class="btncontrol"><input name="nmaxANIR" type="hidden" id="nmaxANIR" value="200" /><input name="heightANIR" type="hidden" id="heightANIR" value="800" /><input name="btnPlayANIR" type="submit" disabled="disabled" class="anibutton" id="btnPlayANIR" title="Play" onclick="playAni('ANIR')" value="  &gt;  " /> <input name="btnPauseANIR" type="submit" disabled="disabled" class="anibutton" id="btnPauseANIR" title="Pause" onclick="pauseAni('ANIR')" value="  O  " /> <input name="btnFastANIR" type="submit" disabled="disabled" class="anibutton" id="btnFastANIR" title="Speed up" onclick="fastAni('ANIR',1)" value="  +  " /> <input name="btnSlowANIR" type="submit" disabled="disabled" class="anibutton" id="btnSlowANIR" title="Slow down" onclick="fastAni('ANIR',-1)" value="  -  " /> <input name="btnPrevANIR" type="submit" disabled="disabled" class="anibutton" id="btnPrevANIR" title="Previous frame" onclick="prevAni('ANIR',1)" value="  &lt;&lt;  " /> <input name="btnNextANIR" type="submit" disabled="disabled" class="anibutton" id="btnNextANIR" title="Next frame" onclick="prevAni('ANIR',-1)" value="  &gt;&gt;  " /> <input name="btnFirstANIR" type="submit" disabled="disabled" class="anibutton" id="btnFirstANIR" title="First frame" onclick="firstAni('ANIR',true)" value="  |&lt;  " /> <input name="btnLastANIR" type="submit" disabled="disabled" class="anibutton" id="btnLastANIR" title="Last frame" onclick="firstAni('ANIR',false)" value="  &gt;|  " /> <input name="btnMoreANIR" type="submit" disabled="disabled" class="anibutton" id="btnMoreANIR" title="More controls" onclick="btnMore('ANIR')" value="  &lt;&gt;  " /></div><div id="moreParANIR" class="morepar"><label title="Which frame to go?" onmouseover="this.style.backgroundColor='#8cacbb'" onmouseout="this.style.backgroundColor='#ffffff'">View <input name="txtFrameANIR" type="text" id="txtFrameANIR" onblur="txtFrame(this.value, 'ANIR')" value="1" size="4" class="text" />/200 frame</label> <label title="Loop or not?" onmouseover="this.style.backgroundColor='#8cacbb'" onmouseout="this.style.backgroundColor='#ffffff'"><input name="checkLoopANIR" type="checkbox" id="checkLoopANIR" checked="checked"/>Loop</label> <label title="Time interval for the animation (in sec)" onmouseover="this.style.backgroundColor='#8cacbb'" onmouseout="this.style.backgroundColor='#ffffff'">Time Interval: <input name="txtIntervalANIR" type="text" id="txtIntervalANIR" onblur="txtInterval(this)" value="1" size="4" class="text" /></label> <label title="Increment in time interval" onmouseover="this.style.backgroundColor='#8cacbb'" onmouseout="this.style.backgroundColor='#ffffff'">Step: <input name="txtStepANIR" type="text" id="txtStepANIR" onblur="txtInterval(this)" value="0.1" size="4" class="text" /></label></div>
<div class="description">
Evolution of 12 populations at 1000 loci were simulated. For each
locus, each of the 12 populations starts at the same allele frequency
and evolves independently, as shown in the upper left plot of allele
frequency for a single locus. On the bottom, we see the current allele
frequency for all loci at this generation, stratified by selection
type and strength. Black dots mark the ancestral allele frequency and
a vertical line marks the locus shown in the upper left plot. In the
upper right, we attempt to estimate the ancestral allele frequency by
taking the mean of the current allele frequencies of all 12
populations. A circle highlights the locus that appears in the upper
left plot.

<br /><br />There are only 2 alleles for each locus: red or blue. The allele frequency changes in each generation via 2 mechanisms: drift and selection. For each locus, drift is the same: Freq[N+1]=rbinom(1000,Freq[N])/1000, since simulated population size is 1000. Selection depends on the color of the population, and the type of selection. For loci not under selection (NEU) and populations of neutral color, there is no allele frequency update (since presumably there is no selective pressure). For loci under positive selection (POS), blue alleles will be favored in blue populations, and disfavored in red populations. For loci under balancing selection (BAL) it is advantageous to have both a blue and red allele in a population that is either blue or red.</div></fieldset><div class="footer">Created by R package "<a href="http://cran.r-project.org/package=animation" target="_blank">animation</a>" written by <a href="http://www.yihui.name/" target="_blank">Yihui XIE</a>.<br>2009-08-10 13:05:31</div></div></body></html>
